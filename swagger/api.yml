openapi: 3.0.0
servers:
  - url: /1.0/
info:
  description: Universal Registrar
  version: "1.0.0"
  title: Universal Registrar
  contact:
    email: markus@danubetech.com
paths:
  /create:
    post:
      summary: Creates a DID.
      operationId: create
      parameters:
        - in: query
          required: true
          name: method
          schema:
            type: string
          description: The requested DID method for the operation.
          example: btcr
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRequest'
      responses:
        '200':
          description: successfully createed!
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateState'
        '400':
          description: invalid input!
        '500':
          description: error!
  /update:
    post:
      summary: Updates a DID.
      operationId: update
      parameters:
        - in: query
          required: true
          name: method
          schema:
            type: string
          description: The requested DID method for the operation.
          example: btcr
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRequest'
      responses:
        '200':
          description: successfully updated!
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateState'
        '400':
          description: invalid input!
        '500':
          description: error!
  /deactivate:
    post:
      summary: Deactivates a DID.
      operationId: deactivate
      parameters:
        - in: query
          required: true
          name: method
          schema:
            type: string
          description: The requested DID method for the operation.
          example: btcr
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeactivateRequest'
      responses:
        '200':
          description: successfully deactivated!
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeactivateState'
        '400':
          description: invalid input!
        '500':
          description: error!
  /properties:
    get:
      summary: Returns a map of properties of the resolver.
      operationId: universalRegistrarGetProperties
      responses:
        '200':
          description: Success.
          content:
            application/did+json:
              schema:
                type: object
                description: A map of properties.
  /methods:
    get:
      summary: Returns a list of supported DID methods.
      operationId: universalRegistrarGetMethods
      responses:
        '200':
          description: Success.
          content:
            application/did+json:
              schema:
                type: array
                items:
                  type: string
                description: The list of supported DID methods.
                example: ["btcr","sov","v1","key"]
components:
  schemas:
    CreateRequest:
      description: Input fields for the create operation.
      type: object
      additionalProperties: false
      properties:
        jobId:
          description:
            This input field is used to keep track of an ongoing DID creation process.
            See <a href="https://identity.foundation/did-registration/#jobid">https://identity.foundation/did-registration/#jobid</a>.
          type: string
          example: 6d85bcd0-2ea3-4288-ab00-15afadd8a156
        options:
          description:
            This input field contains an object with various options for the DID create operation, such as the network where the DID should be created.
            See <a href="https://identity.foundation/did-registration/#options">https://identity.foundation/did-registration/#options</a>.
          type: object
          example: {"chain": "testnet"}
        secret:
          description:
            This input field contains an object with DID controller keys and other secrets needed for performing the DID create operation.
            See <a href="https://identity.foundation/did-registration/#secret">https://identity.foundation/did-registration/#secret</a>.
          type: object
          example: {"seed": "72WGp7NgFR1Oqdi8zlt7jQQ434XR0cNQ"}
        didDocument:
          description:
            This input field contains either a complete DID document, or an incremental change (diff) to a DID document.
            See <a href="https://identity.foundation/did-registration/#diddocument">https://identity.foundation/did-registration/#diddocument</a>.
          type: object
    UpdateRequest:
      description: Input fields for the update operation.
      type: object
      additionalProperties: false
      required:
        - did
      properties:
        jobId:
          description:
            This input field is used to keep track of an ongoing DID update process.
            See <a href="https://identity.foundation/did-registration/#jobid">https://identity.foundation/did-registration/#jobid</a>.
          type: string
          example: 6d85bcd0-2ea3-4288-ab00-15afadd8a156
        did:
          description:
            This input field indicates the DID that is the target of the DID update operation.
          type: string
          example: "did:sov:WRfXPg8dantKVubE3HX8pw"
        options:
          description:
            This input field contains an object with various options for the DID update operation.
            See <a href="https://identity.foundation/did-registration/#options">https://identity.foundation/did-registration/#options</a>.
          type: object
        secret:
          description:
            This input field contains an object with DID controller keys and other secrets needed for performing the DID update operation.
            See <a href="https://identity.foundation/did-registration/#secret">https://identity.foundation/did-registration/#secret</a>.
          type: object
        didDocument:
          description:
            This input field contains either a complete DID document, or an incremental change (diff) to a DID document.
            See <a href="https://identity.foundation/did-registration/#diddocument">https://identity.foundation/did-registration/#diddocument</a>.
          type: object
    DeactivateRequest:
      description: Input fields for the deactivate operation.
      type: object
      additionalProperties: false
      required:
        - did
      properties:
        jobId:
          description:
            This input field is used to keep track of an ongoing DID deactivation process.
            See <a href="https://identity.foundation/did-registration/#jobid">https://identity.foundation/did-registration/#jobid</a>.
          type: string
          example: 6d85bcd0-2ea3-4288-ab00-15afadd8a156
        did:
          description:
            This input field indicates the DID that is the target of the DID deactivation operation.
          type: string
          example: "did:sov:WRfXPg8dantKVubE3HX8pw"
        options:
          description:
            This input field contains an object with various options for the DID deactivate operation.
            See <a href="https://identity.foundation/did-registration/#options">https://identity.foundation/did-registration/#options</a>.
          type: object
        secret:
          description:
            This input field contains an object with DID controller keys and other secrets needed for performing the DID deactivate operation.
            See <a href="https://identity.foundation/did-registration/#secret">https://identity.foundation/did-registration/#secret</a>.
          type: object
    CreateState:
      description: The state after a create operation.
      type: object
      additionalProperties: false
      required:
        - didState
      properties:
        jobId:
          type: string
          example: 6d85bcd0-2ea3-4288-ab00-15afadd8a156
        didState:
          $ref: '#/components/schemas/DidState'
        didRegistrationMetadata:
          type: object
        didDocumentMetadata:
          type: object
    UpdateState:
      description: The state after an update operation.
      type: object
      additionalProperties: false
      required:
        - didState
      properties:
        jobId:
          type: string
          example: 6d85bcd0-2ea3-4288-ab00-15afadd8a156
        didState:
          $ref: '#/components/schemas/DidState'
        didRegistrationMetadata:
          type: object
        didDocumentMetadata:
          type: object
    DeactivateState:
      description: The state after a deactivate operation.
      type: object
      additionalProperties: false
      required:
        - didState
      properties:
        jobId:
          type: string
          example: 6d85bcd0-2ea3-4288-ab00-15afadd8a156
        didState:
          $ref: '#/components/schemas/DidState'
        didRegistrationMetadata:
          type: object
        didDocumentMetadata:
          type: object
    DidState:
      description: The current state of a DID.
      type: object
      additionalProperties: true
      properties:
        state:
          type: string
          example: "finished"
        did:
          type: string
          example: "did:sov:WRfXPg8dantKVubE3HX8pw"
        secret:
          type: object
          example: {
            "keys": [
              {
                "privateKeyJwk": {
                  "kty": "OKP",
                  "d": "NzJXR3A3TmdGUjFPcWRpOHpsdDdqUVE0MzRYUjBjTlE",
                  "crv": "Ed25519",
                  "x": "jpIKKU2b77lNXKTNW2NGvw1GUMjU6v_l_tLJAH5uYz0"
                },
                "publicKeyDIDURL": "did:sov:WRfXPg8dantKVubE3HX8pw#key-1"
              }
            ]
          }
        didDocument:
          type: object
